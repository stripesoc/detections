//StripeSOC Team - Hermetic Wiper Class 3
//Filehashes and Filenames known to belong to the abused HermeticWiper driver
//No known caveats other than these attributes will likely be updated soon in the future
DeviceFileEvents
| where SHA256 in~ ("e5f3ef69a534260e899a36cec459440dc572388defd8f1d98760d31c700f42d5","96b77284744f8761c4f2558388e0aee2140618b484ff53fa8b222b340d2a9c84","b01e0c6ac0b8bcde145ab7b68cf246deea9402fa7ea3aede7105f7051fe240c1","8c614cf476f871274aa06153224e8f7354bf5e23e6853358591bf35a381fb75b","b6f2e008967c5527337448d768f2332d14b92de22a1279fd4d91000bb3d4a0fd","23ef301ddba39bb00f0819d2061c9c14d17dc30f780a945920a51bc3ba0198a4","fd7eacc2f87aceac865b0aa97a50503d44b799f27737e009f91f3c281233c17d","2c7732da3dcfc82f60f063f2ec9fa09f9d38d5cfbe80c850ded44de43bdb666d") or (FileName in~ ("DRV_X64","DRV_X86","DRV_XP_X64","DRV_XP_X86"))
| extend HashAlgorithm = tostring(iff(isnotempty(SHA256), "SHA256", ''))